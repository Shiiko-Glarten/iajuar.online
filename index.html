<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>iajuar — kit outline editor</title>

  <!-- JetBrains Mono -->
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0b0b;
      --ink:#eaeaea;
      --ink-dim:#bdbdbd;
      --tip:#111;
      --accent:#ffffff;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:"JetBrains Mono",monospace;line-height:1.55}
    .wrap{max-width:1200px;margin:24px auto;padding:0 12px}
    .imgStage{position:relative;user-select:none}
    .imgStage>img{display:block;max-width:100%;height:auto;margin:0 auto}

    /* Outline hotspot */
    .outline{
      position:absolute;
      border:2px solid rgba(255,255,255,.7);
      border-radius:6px;
      cursor:pointer;
    }
    .outline:hover{border-color:rgba(255,255,255,1);}

    /* Tooltip */
    .tip{
      position:absolute; left:50%; top:-10px; transform:translate(-50%,-100%);
      background:var(--tip); color:var(--ink);
      padding:6px 8px; border-radius:8px; font-size:12px;
      white-space:nowrap; pointer-events:none; opacity:0; transition:opacity .15s ease;
      box-shadow:0 4px 14px rgba(0,0,0,.35);
    }
    .outline:hover .tip{opacity:1;}

    /* Toolbar */
    .bar{
      position:sticky; top:0; z-index:10; background:#111; border:1px solid #222;
      padding:10px 12px; display:flex; gap:10px; align-items:center; justify-content:space-between
    }
    .bar small{color:var(--ink-dim)}
    .bar button{
      background:#1b1b1b;color:#eee;border:1px solid #2c2c2c;border-radius:8px;padding:8px 10px;font-family:inherit;cursor:pointer
    }
    .bar button:hover{background:#242424}
    .pill{display:inline-flex;gap:6px;align-items:center}
    .pill b{color:#fff}
    .msg{font-size:.9rem;color:var(--ink-dim)}
  </style>
</head>
<body>

  <div class="bar wrap" id="toolbar">
    <div class="pill">
      <b>Outline editor</b>
      <small id="modeHint" class="msg">Click-drag to draw a rectangle around each item. Hover to see label.</small>
    </div>
    <div class="pill">
      <small id="itemLabel" class="msg"></small>
      <button id="prevBtn">◀︎ Prev</button>
      <button id="nextBtn">Next ▶︎</button>
      <button id="saveBtn">Save</button>
      <button id="resetBtn">Reset</button>
      <button id="exportBtn">Export JSON</button>
    </div>
  </div>

  <div class="wrap">
    <div class="imgStage" id="stage">
      <img id="kit" src="IMG_4435.jpeg" alt="kit layout" />
    </div>
  </div>

<script>
const ITEMS = [
  "First Aid Kit","Umbrella","Admin Organizer","Bandana","Mask","Cap","Carabiner",
  "A6 Notebook","International Drivers Permit","Passport/Visa Photos","Wallet","Coin Carrier",
  "Passport","Uniball Vision Elite","PaperMate Flair","Combat Boots","Barefoot Sandals","Hygiene Kit",
  "REI Trail 25","MacBook Air","Packable Tote","Fjallraven Greenland Pocket","Clothing + Stuffsack",
  "Belt","Apple Watch S10","AirTag x2","35W Adapter","Chargers","AirPods Pro","Anker 10k Powerbank",
  "Regional Adapter","128gb Flash Drive","Headphone Adapter","Headlamp"
];

const STORE_KEY = "iajuar_outlines_v1";
let outlines = loadOutlines();
let idx = firstUnplacedIndex(outlines);

const stage = document.getElementById('stage');
const img = document.getElementById('kit');
const itemLabel = document.getElementById('itemLabel');

function loadOutlines(){
  const saved = localStorage.getItem(STORE_KEY);
  if(saved){
    try{
      const arr = JSON.parse(saved);
      if(Array.isArray(arr) && arr.length === ITEMS.length) return arr;
    }catch(e){}
  }
  return new Array(ITEMS.length).fill(null);
}
function firstUnplacedIndex(arr){ const i=arr.findIndex(p=>!p); return i===-1?0:i; }
function setLabel(){ itemLabel.textContent=`Item ${idx+1}/${ITEMS.length}: ${ITEMS[idx]}`; }
function save(){ localStorage.setItem(STORE_KEY, JSON.stringify(outlines)); }
function resetAll(){
  localStorage.removeItem(STORE_KEY);
  outlines=new Array(ITEMS.length).fill(null);
  idx=0; setLabel(); renderOutlines();
}
function exportJSON(){
  const txt = JSON.stringify(outlines);
  navigator.clipboard?.writeText(txt);
  alert("Outline coordinates copied:\n\n"+txt);
}

let startX,startY,drawing=false;
img.addEventListener('mousedown',(e)=>{
  const r=img.getBoundingClientRect();
  startX=((e.clientX-r.left)/r.width)*100;
  startY=((e.clientY-r.top)/r.height)*100;
  drawing=true;
});
img.addEventListener('mousemove',(e)=>{
  if(!drawing) return;
  renderOutlines();
  const r=img.getBoundingClientRect();
  const curX=((e.clientX-r.left)/r.width)*100;
  const curY=((e.clientY-r.top)/r.height)*100;
  const x=Math.min(startX,curX), y=Math.min(startY,curY);
  const w=Math.abs(startX-curX), h=Math.abs(startY-curY);
  const o=document.createElement('div');
  o.className='outline'; o.style.left=x+'%';o.style.top=y+'%';o.style.width=w+'%';o.style.height=h+'%';
  o.innerHTML=`<span class="tip">${ITEMS[idx]}</span>`;
  stage.appendChild(o);
});
img.addEventListener('mouseup',(e)=>{
  if(!drawing) return; drawing=false;
  const r=img.getBoundingClientRect();
  const endX=((e.clientX-r.left)/r.width)*100;
  const endY=((e.clientY-r.top)/r.height)*100;
  outlines[idx]={left:Math.min(startX,endX),top:Math.min(startY,endY),
    width:Math.abs(startX-endX),height:Math.abs(startY-endY)};
  idx=(idx+1)%ITEMS.length; setLabel(); renderOutlines();
});
function renderOutlines(){
  [...stage.querySelectorAll('.outline')].forEach(n=>n.remove());
  outlines.forEach((o,i)=>{
    if(!o) return;
    const d=document.createElement('div');
    d.className='outline'; d.style.left=o.left+'%'; d.style.top=o.top+'%';
    d.style.width=o.width+'%'; d.style.height=o.height+'%';
    d.innerHTML=`<span class="tip">${ITEMS[i]}</span>`;
    stage.appendChild(d);
  });
}

// toolbar buttons
document.getElementById('prevBtn').onclick=()=>{ idx=(idx-1+ITEMS.length)%ITEMS.length; setLabel(); };
document.getElementById('nextBtn').onclick=()=>{ idx=(idx+1)%ITEMS.length; setLabel(); };
document.getElementById('saveBtn').onclick=save;
document.getElementById('resetBtn').onclick=resetAll;
document.getElementById('exportBtn').onclick=exportJSON;

img.onload=()=>{ setLabel(); renderOutlines(); };
</script>
</body>
</html>
