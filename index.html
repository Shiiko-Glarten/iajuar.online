<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>iajuar — kit outline editor</title>

  <!-- JetBrains Mono -->
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0b0b;
      --ink:#eaeaea;
      --ink-dim:#bdbdbd;
      --tip:#111;
      --accent:#ffffff;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:"JetBrains Mono",monospace;line-height:1.55}
    .wrap{max-width:1200px;margin:24px auto;padding:0 12px}
    .imgStage{position:relative;user-select:none}
    .imgStage>img{display:block;max-width:100%;height:auto;margin:0 auto}
    
    /* Outline hotspot */
    .outline{
      position:absolute;
      border:2px solid rgba(255,255,255,.7);
      border-radius:6px;
      cursor:pointer;
    }
    .outline:hover{border-color:rgba(255,255,255,1);}
    
    /* Tooltip */
    .tip{
      position:absolute; left:50%; top:-10px; transform:translate(-50%,-100%);
      background:var(--tip); color:var(--ink);
      padding:6px 8px; border-radius:8px; font-size:12px;
      white-space:nowrap; pointer-events:none; opacity:0; transition:opacity .15s ease;
      box-shadow:0 4px 14px rgba(0,0,0,.35);
    }
    .outline:hover .tip{opacity:1;}

    /* toolbar & other UI */
    .bar{
      position:sticky; top:0; z-index:10; background:#111; border:1px solid #222; border-left:none;border-right:none;
      padding:10px 12px; display:flex; gap:10px; align-items:center; justify-content:space-between
    }
    .bar small{color:var(--ink-dim)}
    .bar button{
      background:#1b1b1b;color:#eee;border:1px solid #2c2c2c;border-radius:8px;padding:8px 10px;font-family:inherit;cursor:pointer
    }
    .bar button:hover{background:#242424}
    .pill{display:inline-flex;gap:6px;align-items:center}
    .pill b{color:#fff}
    .kbd{font-size:.85em;background:#181818;border:1px solid #2b2b2b;border-bottom-color:#222;border-radius:6px;padding:2px 6px}
    .msg{font-size:.9rem;color:var(--ink-dim)}
    #description{max-width:900px;margin:24px auto 64px;background:#0f0f0f;border:1px solid #1d1d1d;border-radius:14px;padding:18px}
    #description h2{margin:0 0 10px 0;font-size:1.05rem;color:#fff}
    #description p{margin:0;color:#cfcfcf}
  </style>
</head>
<body>

  <div class="bar wrap" id="toolbar">
    <div class="pill">
      <b>Outline editor</b>
      <small id="modeHint" class="msg">Click-drag to draw a rectangle around each item. Hover to see label.</small>
    </div>
    <div class="pill">
      <small id="itemLabel" class="msg"></small>
      <button id="prevBtn">◀︎ Prev</button>
      <button id="nextBtn">Next ▶︎</button>
      <button id="saveBtn">Save</button>
      <button id="resetBtn">Reset</button>
      <button id="exportBtn">Export JSON</button>
    </div>
  </div>

  <div class="wrap">
    <div class="imgStage" id="stage">
      <!-- Absolute URL so it *always* loads -->
      <img id="kit" src="https://Shiiko-Glarten.github.io/iajuar.online/images/IMG_4435.jpeg" alt="kit layout" />
      <!-- outlines will be injected here -->
    </div>
  </div>

  <div id="description" class="wrap">
    <h2>DESCRIPTION</h2>
    <p>Hover over any rectangle to see the label.</p>
  </div>

<script>
const ITEMS = [
  "First Aid Kit","Umbrella","Admin Organizer","Bandana","Mask","Cap","Carabiner",
  "A6 Notebook","International Drivers Permit","Passport/Visa Photos","Wallet","Coin Carrier",
  "Passport","Uniball Vision Elite","PaperMate Flair","Combat Boots","Barefoot Sandals","Hygiene Kit",
  "REI Trail 25","MacBook Air","Packable Tote","Fjallraven Greenland Pocket","Clothing + Stuffsack",
  "Belt","Apple Watch S10","AirTag x2","35W Adapter","Chargers","AirPods Pro","Anker 10k Powerbank",
  "Regional Adapter","128gb Flash Drive","Headphone Adapter","Headlamp"
];

const STORE_KEY = "iajuar_outlines_v1";
let outlines = loadOutlines(); 
let idx = firstUnplacedIndex(outlines);

const stage = document.getElementById('stage');
const img = document.getElementById('kit');
const itemLabel = document.getElementById('itemLabel');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const saveBtn = document.getElementById('saveBtn');
const resetBtn = document.getElementById('resetBtn');
const exportBtn = document.getElementById('exportBtn');

function loadOutlines(){
  const saved = localStorage.getItem(STORE_KEY);
  if(saved){
    try{
      const arr = JSON.parse(saved);
      if(Array.isArray(arr) && arr.length === ITEMS.length) return arr;
    }catch(e){}
  }
  return new Array(ITEMS.length).fill(null);
}
function firstUnplacedIndex(arr){
  const i = arr.findIndex(p => !p);
  return i === -1 ? 0 : i;
}
function setLabel(){
  itemLabel.textContent = `Item ${idx+1}/${ITEMS.length}: ${ITEMS[idx]}`;
}
function save(){ localStorage.setItem(STORE_KEY, JSON.stringify(outlines)); }
function resetAll(){
  localStorage.removeItem(STORE_KEY);
  outlines = new Array(ITEMS.length).fill(null);
  idx = 0;
  setLabel();
  renderOutlines();
}
function exportJSON(){
  const txt = JSON.stringify(outlines);
  navigator.clipboard?.writeText(txt);
  alert("Outline coordinates copied to clipboard.\n\n" + txt);
}

let startX, startY, drawing = false;

img.addEventListener('mousedown', (e)=>{
  if(idx === null) return;
  const rect = img.getBoundingClientRect();
  startX = ((e.clientX - rect.left)/rect.width)*100;
  startY = ((e.clientY - rect.top)/rect.height)*100;
  drawing = true;
});

img.addEventListener('mousemove', (e)=>{
  if(!drawing) return;
  renderOutlines(); // clear temp overlay
  const rect = img.getBoundingClientRect();
  const currentX = ((e.clientX - rect.left)/rect.width)*100;
  const currentY = ((e.clientY - rect.top)/rect.height)*100;

  const x = Math.min(startX,currentX);
  const y = Math.min(startY,currentY);
  const w = Math.abs(startX-currentX);
  const h = Math.abs(startY-currentY);

  const outline = document.createElement('div');
  outline.className = 'outline';
  outline.style.left = x + '%';
  outline.style.top = y + '%';
  outline.style.width = w + '%';
  outline.style.height = h + '%';
  outline.innerHTML = `<span class="tip">${ITEMS[idx]}</span>`;
  stage.appendChild(outline);
});

img.addEventListener('mouseup', (e)=>{
  if(!drawing) return;
  drawing = false;
  const rect = img.getBoundingClientRect();
  const endX = ((e.clientX - rect.left)/rect.width)*100;
  const endY = ((e.clientY - rect.top)/rect.height)*100;

  outlines[idx] = {
    left: Math.min(startX,endX),
    top: Math.min(startY,endY),
    width: Math.abs(startX-endX),
    height: Math.abs(startY-endY)
  };
  idx = (idx + 1) % ITEMS.length;
  setLabel();
  renderOutlines();
});

function renderOutlines(){
  [...stage.querySelectorAll('.outline')].forEach(n=>n.remove());
  outlines.forEach((o,i)=>{
    if(!o) return;
    const outline = document.createElement('div');
    outline.className = 'outline';
    outline.style.left = o.left + '%';
    outline.style.top = o.top + '%';
    outline.style.width = o.width + '%';
    outline.style.height = o.height + '%';
    outline.innerHTML = `<span class="tip">${ITEMS[i]}</span>`;
    stage.appendChild(outline);
  });
}

// Toolbar buttons
prevBtn.addEventListener('click', ()=>{ idx = (idx-1+ITEMS.length)%ITEMS.length; setLabel(); });
nextBtn.addEventListener('click', ()=>{ idx = (idx+1)%ITEMS.length; setLabel(); });
saveBtn.addEventListener('click', save);
resetBtn.addEventListener('click', resetAll);
exportBtn.addEventListener('click', exportJSON);

img.addEventListener('load', ()=>{
  setLabel();
  renderOutlines();
});
</script>

</body>
</html>
